spring:
  application:
    name: wallet-service
  task:
    scheduling:
      pool:
        size: 2  # Number of threads for scheduled tasks
      thread-name-prefix: "scheduled-"

  datasource:
    url: ${DB_URL:jdbc:postgresql://localhost:5432/wallet_db}
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 10
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000

  jpa:
    hibernate:
      ddl-auto: update  # Use 'validate' in production
    show-sql: true
    properties:
      hibernate:
        format_sql: true
        dialect: org.hibernate.dialect.PostgreSQLDialect
        jdbc:
          time_zone: UTC
        jdbc.batch_size: 20
        order_inserts: true
        order_updates: true
    open-in-view: false

  sql:
    init:
      mode: never  # Use Flyway/Liquibase for production

server:
  port: ${PORT:8082}
  error:
    include-message: always
    include-binding-errors: always

services:
  ledger:
    url: ${LEDGER_SERVICE_URL:http://localhost:8084}
    enabled: ${LEDGER_SERVICE_ENABLED:true}
  notification:
    url: ${NOTIFICATION_SERVICE_URL:http://localhost:8085}
    enabled: ${NOTIFICATION_SERVICE_ENABLED:true}

wallet:
  large-transaction-threshold: ${LARGE_TX_THRESHOLD:100000}  # $1000.00 in cents

# Payment Provider Configuration
payment:
  providers:
    payme:
      merchant-id: ${PAYME_MERCHANT_ID:mock}
      secret-key: ${PAYME_SECRET_KEY:mock}
      api-url: ${PAYME_API_URL:https://checkout.paycom.uz/api}
      webhook-secret: ${PAYME_WEBHOOK_SECRET:mock}
    click:
      merchant-id: ${CLICK_MERCHANT_ID:mock}
      service-id: ${CLICK_SERVICE_ID:mock}
      merchant-user-id: ${CLICK_MERCHANT_USER_ID:mock}
      secret-key: ${CLICK_SECRET_KEY:mock}
      api-url: ${CLICK_API_URL:https://api.click.uz/v2}
    stripe:
      secret-key: ${STRIPE_SECRET_KEY:mock}
      publishable-key: ${STRIPE_PUBLISHABLE_KEY:mock}
      webhook-secret: ${STRIPE_WEBHOOK_SECRET:mock}
      api-url: ${STRIPE_API_URL:https://api.stripe.com/v1}

logging:
  level:
    com.fintech.wallet: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %logger{36} - %msg%n"